<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="comment">

<!-- 글목록조회 -->
<select id="list" resultType="comment.CommentVO">
	SELECT a.board_id, a.email, b.filepath, a.title, a.content, a.writedate, a.help_cnt, a.model_code, a.cmt_code, b.social_code
	FROM  board a LEFT OUTER JOIN userinfo b
	ON    a.email = b.email
	WHERE model_code like #{model_code}
	<if test="cmt_code neq 'a'.toString()" >
	AND	  cmt_code like #{cmt_code}
	</if>
	ORDER BY BOARD_id DESC
</select>

<!-- 글 삽입 -->
<insert id="comment_insert">
		INSERT INTO	board (email,  content,  model_code, cmt_code)
		VALUES		(#{email}, #{content}, #{model_code},  #{cmt_code})
</insert>
<!-- 글 수정 -->
<update id="update" >

		UPDATE	board 
		SET		email = #{email}
				,content = #{content}
				,cmt_code =  #{cmt_code}
		WHERE	board_id = #{board_id}
</update>

<!-- 댓글목록조회 -->
<select id="coment_list" resultType="comment.ReplyVO">
	SELECT a.board_id, a.rep_no, a.email, a.content, a.writedate, a.help_cnt, b.filepath, b.social_code
	FROM  reply a LEFT OUTER JOIN userinfo b
	ON    a.email = b.email
	WHERE board_id like #{board_id}
	ORDER BY rep_no DESC
</select>

<!-- 댓글삽입저장 -->
<insert id="coment_insert">
	INSERT INTO reply (email, board_id, content)
	VALUES (#{email}, #{board_id}, #{content})
</insert>

<!-- 댓글 수정 -->
<update id="comment_update">
		UPDATE	reply 
		SET		content = #{content}
		WHERE	rep_no = #{rep_no}
</update>

<!-- 댓글 삭제 -->
<delete id="comment_reply_delete">
	DELETE 
	FROM	reply
	WHERE	rep_no = #{rep_no}
</delete>
</mapper>
