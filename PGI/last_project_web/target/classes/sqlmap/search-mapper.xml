<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="search">
<select id="serach_text" resultType="search.CategorySearchVO">
	SELECT    b.brand_name, m.model_name, m.model_code, m.filepath,  c.category_name
	FROM      (SELECT    model_info.*
	           FROM     (SELECT  model_name
	                     FROM    name_div
	                     WHERE   LOWER(model_name_div) LIKE '%' || LOWER(#{search_div_text}) || '%') d INNER JOIN  model_info 
	           ON        (model_info.model_name = d.model_name OR model_info.model_code = d.model_name)) m LEFT OUTER JOIN category c
	ON       c.category_code = m.category_code LEFT OUTER JOIN brand b
	ON       b.brand_code = m.brand_code
</select>
<select id="model_code_list" resultType="search.CategorySearchVO">
	SELECT a.model_code, a.model_name, a.filepath, b.brand_name, c.category_name
	FROM	model_info a LEFT OUTER JOIN brand b
	ON		a.brand_code = b.brand_code LEFT OUTER JOIN category c
	ON		a.category_code = c.category_code
	WHERE	a.model_code LIKE #{model_code}
</select>

</mapper>